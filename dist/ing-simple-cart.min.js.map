{"version":3,"file":"ing-simple-cart.min.js","sources":["../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../utils/localstorage.js","../index.js"],"sourcesContent":["function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import * as data from '../data/product.json'\nimport * as userData from '../data/user.json'\n\nconst STORAGE_KEY = '__cart'\n\nlet saveListener = null;\n\nexport const listen = (cb) => { saveListener = cb }; // ugly but storage listener is not working for the same window..\n\nexport const list = (key) => JSON.parse(localStorage.getItem(key || STORAGE_KEY)) || [];\n\nexport const products = () => JSON.parse(JSON.stringify(data)) || [];\n\nexport const user = () => JSON.parse(JSON.stringify(userData)) || {};\n\nexport const save = (data, key) => {\n\tlocalStorage.setItem(key || STORAGE_KEY, JSON.stringify(data));\n\tif(saveListener) saveListener(list(key || STORAGE_KEY))\n}\n\nexport const clear = (key) => {\n\tlocalStorage.removeItem(key || STORAGE_KEY)\n\tif(saveListener) saveListener(list(key || STORAGE_KEY))\n}\n","import { user, products, list, save, clear, listen } from './utils/localstorage'\nimport pkg from './package.json';\n// import '@lion/input/lion-input.js';\n// import '@lion/button/lion-button.js';\n\nconsole.log(`running version ${pkg.version}`);\n\nconst get = (id) => list().find((product) => product.productId === id)\n\nconst exists = (id) => !!get(id)\n\nconst add = (product, quantity) => isValid(product) ? exists(product.productId) ? update(product.productId, 'quantity', get(product.productId).quantity + (quantity || 1)) : save(list().concat({ ...product, quantity: quantity || 1 })) : null;\n\nconst remove = (id) => save(list().filter((product) => product.productId !== id))\n\nconst quantity = (id, diff) => exists(id) && get(id).quantity + diff > 0 ? update(id, 'quantity', get(id).quantity + diff) : remove(id);\n\nconst update = (id, field, value) => save(list().map((product) => product.productId === id ? ({ ...product, [field]: value }) : product))\n\nconst total = (cb) => list().reduce((sum, product) => isCallback(cb) ? cb(sum, product) : (sum += subtotal(product)), 0);\n\nconst destroy = () => clear()\n\nconst onChange = (cb) => isCallback(cb) ? listen(cb) : console.log(typeof cb)\n\nconst isValid = (product) => product.productId && product.price\n\nconst subtotal = (product) => isCalcable(product) ? (product.price * product.quantity) : 0\n\nconst isCalcable = (product) => (product && product.price && product.quantity)\n\nconst isCallback = (cb) => cb && typeof cb === \"function\"\n\nconst cartCount = () => list().length;\n\nexport { user, products, list, get, add, remove, update, quantity, total, destroy, exists, subtotal, onChange, cartCount };\n\n"],"names":["_typeof","obj","Symbol","iterator","module","constructor","prototype","_defineProperty","key","value","Object","defineProperty","enumerable","configurable","writable","STORAGE_KEY","saveListener","listen","cb","list","JSON","parse","localStorage","getItem","products","stringify","data","user","userData","save","setItem","clear","removeItem","console","log","pkg","version","get","id","find","product","productId","exists","add","quantity","isValid","update","concat","remove","filter","diff","field","map","total","reduce","sum","isCallback","subtotal","destroy","onChange","price","isCalcable","cartCount","length"],"mappings":"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"}